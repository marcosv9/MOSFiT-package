
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>chaosmagpy.model_utils.design_gauss &#8212; ChaosMagPy 0.12 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="chaosmagpy.model_utils.colloc_matrix" href="chaosmagpy.model_utils.colloc_matrix.html" />
    <link rel="prev" title="chaosmagpy.model_utils.design_matrix" href="chaosmagpy.model_utils.design_matrix.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="chaosmagpy.model_utils.colloc_matrix.html" title="chaosmagpy.model_utils.colloc_matrix"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chaosmagpy.model_utils.design_matrix.html" title="chaosmagpy.model_utils.design_matrix"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ChaosMagPy 0.12 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../references.html" accesskey="U">API References</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">chaosmagpy.model_utils.design_gauss</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="chaosmagpy-model-utils-design-gauss">
<h1>chaosmagpy.model_utils.design_gauss<a class="headerlink" href="#chaosmagpy-model-utils-design-gauss" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="chaosmagpy.model_utils.design_gauss">
<span class="sig-prename descclassname"><span class="pre">chaosmagpy.model_utils.</span></span><span class="sig-name descname"><span class="pre">design_gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/chaosmagpy/model_utils.html#design_gauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#chaosmagpy.model_utils.design_gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes matrices to connect the radial, colatitude and azimuthal field
components to the magnetic potential field in terms of spherical harmonic
coefficients (Schmidt quasi-normalized).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>radius</strong><span class="classifier">ndarray, shape (…)</span></dt><dd><p>Array containing the radius in kilometers.</p>
</dd>
<dt><strong>theta</strong><span class="classifier">ndarray, shape (…)</span></dt><dd><p>Array containing the colatitude in degrees
<span class="math notranslate nohighlight">\([0^\circ,180^\circ]\)</span>.</p>
</dd>
<dt><strong>phi</strong><span class="classifier">ndarray, shape (…)</span></dt><dd><p>Array containing the longitude in degrees.</p>
</dd>
<dt><strong>nmax</strong><span class="classifier">int, positive</span></dt><dd><p>Maximum degree of the sphercial harmonic expansion.</p>
</dd>
<dt><strong>nmin</strong><span class="classifier">int, positive, optional</span></dt><dd><p>Minimum degree of the sphercial harmonic expansion (defaults to 1).</p>
</dd>
<dt><strong>mmax</strong><span class="classifier">int, positive, optional</span></dt><dd><p>Maximum order of the spherical harmonic expansion (defaults to
<code class="docutils literal notranslate"><span class="pre">nmax</span></code>). For <code class="docutils literal notranslate"><span class="pre">mmax</span> <span class="pre">=</span> <span class="pre">0</span></code>, for example, only the zonal terms are
returned.</p>
</dd>
<dt><strong>source</strong><span class="classifier">{‘internal’, ‘external’}, optional</span></dt><dd><p>Magnetic field source (default is an internal source).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>A_radius, A_theta, A_phi</strong><span class="classifier">ndarray, shape (…, M)</span></dt><dd><p>Matrices for radial, colatitude and azimuthal field components. The
second dimension <code class="docutils literal notranslate"><span class="pre">M</span></code> varies depending on <code class="docutils literal notranslate"><span class="pre">nmax</span></code>, <code class="docutils literal notranslate"><span class="pre">nmin</span></code> and
<code class="docutils literal notranslate"><span class="pre">mmax</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The function can also return the design matrix for the field components at
the geographic poles, i.e. where <code class="docutils literal notranslate"><span class="pre">theta</span> <span class="pre">==</span> <span class="pre">0.</span></code> or <code class="docutils literal notranslate"><span class="pre">theta</span> <span class="pre">==</span> <span class="pre">180.</span></code>.
However, users should be careful when doing this because the vector basis
for spherical geocentric coordinates,
<span class="math notranslate nohighlight">\({{\mathbf{e}_r, \mathbf{e}_\theta, \mathbf{e}_\phi}}\)</span>,
depends on longitude, which is not well defined at the poles. That is,
at the poles, any value for the longitude maps to the same location in
euclidean coordinates but gives a different vector basis in spherical
geocentric coordinates. Nonetheless, by choosing a specific value for the
longitude at the poles, users can define the vector basis, which then
establishes the meaning of the spherical geocentric components. The vector
basis for the horizontal components is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{e}_\theta &amp;= \cos\theta\cos\phi\mathbf{e}_x -
    \cos\theta\sin\phi\mathbf{e}_y - \sin\theta\mathbf{e}_z\\
\mathbf{e}_\phi &amp;= -\sin\phi\mathbf{e}_x +
    \cos\phi\mathbf{e}_y\end{split}\]</div>
<p>Hence, at the geographic north pole as given by <code class="docutils literal notranslate"><span class="pre">theta</span> <span class="pre">=</span> <span class="pre">0.</span></code> and
<code class="docutils literal notranslate"><span class="pre">phi</span> <span class="pre">=</span> <span class="pre">0.</span></code> (chosen by the user), the returned design matrix <code class="docutils literal notranslate"><span class="pre">A_theta</span></code>
will be for components along the direction
<span class="math notranslate nohighlight">\(\mathbf{e}_\theta = \mathbf{e}_x\)</span> and <code class="docutils literal notranslate"><span class="pre">A_phi</span></code> for components
along <span class="math notranslate nohighlight">\(\mathbf{e}_\phi = \mathbf{e}_y\)</span>. However,
if <code class="docutils literal notranslate"><span class="pre">phi</span> <span class="pre">=</span> <span class="pre">180.</span></code> is chosen, <code class="docutils literal notranslate"><span class="pre">A_theta</span></code> will be for components along
<span class="math notranslate nohighlight">\(\mathbf{e}_\theta = -\mathbf{e}_x\)</span> and <code class="docutils literal notranslate"><span class="pre">A_phi</span></code>
along <span class="math notranslate nohighlight">\(\mathbf{e}_\phi = -\mathbf{e}_y\)</span>.</p>
</div>
<p class="rubric">Examples</p>
<p>Create the design matrices given 4 locations on the Earth’s surface:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="mf">6371.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">90.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">110.</span><span class="p">,</span> <span class="mf">120.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_radius</span><span class="p">,</span> <span class="n">A_theta</span><span class="p">,</span> <span class="n">A_phi</span> <span class="o">=</span> <span class="n">design_gauss</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_radius</span>
<span class="go">array([[ 1.22464680e-16, 2.00000000e+00, 0.00000000e+00],</span>
<span class="go">       [-3.47296355e-01, 1.96961551e+00, 0.00000000e+00],</span>
<span class="go">       [-6.84040287e-01, 1.87938524e+00, 0.00000000e+00],</span>
<span class="go">       [-1.00000000e+00, 1.73205081e+00, 0.00000000e+00]])</span>
</pre></div>
</div>
<p>Say, only the axial dipole coefficient is non-zero, what is the magnetic
field in terms of spherical geocentric components?</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">30000</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>  <span class="c1"># model coefficients in nT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Br</span> <span class="o">=</span> <span class="n">A_radius</span> <span class="o">@</span> <span class="n">m</span><span class="p">;</span> <span class="n">Br</span>
<span class="go">array([-3.67394040e-12, 1.04188907e+04, 2.05212086e+04, 3.00000000e+04])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bt</span> <span class="o">=</span> <span class="n">A_theta</span> <span class="o">@</span> <span class="n">m</span><span class="p">;</span> <span class="n">Bt</span>
<span class="go">array([-30000. , -29544.23259037, -28190.77862358, -25980.76211353])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bp</span> <span class="o">=</span> <span class="n">A_phi</span> <span class="o">@</span> <span class="n">m</span><span class="p">;</span> <span class="n">Bp</span>
<span class="go">array([0., 0., 0., 0.])</span>
</pre></div>
</div>
<p>A more complete example is given below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">chaosmagpy.model_utils</span> <span class="kn">import</span> <span class="n">design_gauss</span><span class="p">,</span> <span class="n">synth_values</span>

<span class="n">nmax</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># desired truncation degree, i.e. 35 model coefficients</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>  <span class="c1"># example model coefficients</span>

<span class="c1"># example locations</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">radius</span> <span class="o">=</span> <span class="mf">6371.2</span>  <span class="c1"># Earth&#39;s surface</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">180.</span><span class="p">,</span> <span class="mf">180.</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># azimuth in degrees</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">179.</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># colatitude in degrees</span>

<span class="c1"># compute design matrices to compute predictions of the</span>
<span class="c1"># field components from the model coefficients, each is of shape N x 35</span>
<span class="n">A_radius</span><span class="p">,</span> <span class="n">A_theta</span><span class="p">,</span> <span class="n">A_phi</span> <span class="o">=</span> <span class="n">design_gauss</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">nmax</span><span class="o">=</span><span class="n">nmax</span><span class="p">)</span>

<span class="c1"># magnetic components computed from the model</span>
<span class="n">Br_pred</span> <span class="o">=</span> <span class="n">A_radius</span> <span class="o">@</span> <span class="n">coeffs</span>
<span class="n">Bt_pred</span> <span class="o">=</span> <span class="n">A_theta</span> <span class="o">@</span> <span class="n">coeffs</span>
<span class="n">Bp_pred</span> <span class="o">=</span> <span class="n">A_phi</span> <span class="o">@</span> <span class="n">coeffs</span>

<span class="c1"># compute the magnetic components directly from the coefficients</span>
<span class="n">Br</span><span class="p">,</span> <span class="n">Bt</span><span class="p">,</span> <span class="n">Bp</span> <span class="o">=</span> <span class="n">synth_values</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Br</span> <span class="o">-</span> <span class="n">Br_pred</span><span class="p">)</span>  <span class="c1"># approx 0.</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Bt</span> <span class="o">-</span> <span class="n">Bt_pred</span><span class="p">)</span>  <span class="c1"># approx 0.</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Bp</span> <span class="o">-</span> <span class="n">Bp_pred</span><span class="p">)</span>  <span class="c1"># approx 0.</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../references.html">API References</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../references.html#core-functionality">Core Functionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#coordinate-transformations">Coordinate Transformations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../references.html#model-utilities">Model Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#plotting-utilities">Plotting Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#data-utilities">Data Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#configuration-utilities">Configuration Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="chaosmagpy.model_utils.design_matrix.html"
                        title="previous chapter">chaosmagpy.model_utils.design_matrix</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="chaosmagpy.model_utils.colloc_matrix.html"
                        title="next chapter">chaosmagpy.model_utils.colloc_matrix</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/functions/chaosmagpy.model_utils.design_gauss.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="chaosmagpy.model_utils.colloc_matrix.html" title="chaosmagpy.model_utils.colloc_matrix"
             >next</a> |</li>
        <li class="right" >
          <a href="chaosmagpy.model_utils.design_matrix.html" title="chaosmagpy.model_utils.design_matrix"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">ChaosMagPy 0.12 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../references.html" >API References</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">chaosmagpy.model_utils.design_gauss</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, Clemens Kloss.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
  </body>
</html>